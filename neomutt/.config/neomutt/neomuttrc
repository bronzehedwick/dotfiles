# Account options.
set my_user = "iam@chrisdeluca.me"
set from = $my_user
set real_name = "Chris DeLuca"
set use_from = yes
set user_agent = yes
alternates code@chrisdeluca.me|contact@chrisdeluca.me|signups@chrisdeluca.me|bronzehedwick@gmail.com|christopher.j.deluca@gmail.com|chris.deluca@lullabot.com
set header_cache = ~/.cache/neomutt/header_cache

# Mail behavior.
set mail_check = 0
set use_envelope_from = yes
set reverse_name = yes
set reverse_real_name = no
# unset move
set delete = yes
set quit = yes
set charset = "utf-8"
set send_charset = "utf-8"
set assumed_charset = "utf-8"
set fast_reply = yes
set include = yes
set mark_old = no
set history_remove_dups = yes

# mail type
set mbox_type = Maildir
set sendmail = /opt/homebrew/bin/msmtp
set folder = ~/.local/share/neomutt/mailbox
set spool_file = +/
set record = +/
set postponed = +/../draftbox

# virtual folders
set nm_default_url = "notmuch:///Users/chris/.local/share/neomutt/mailbox"
set virtual_spool_file = yes
virtual-mailboxes "Home" "notmuch://?query=folder:chris/INBOX"
virtual-mailboxes "Lullabot" "notmuch://?query=folder:lullabot/INBOX"

# general key bindings.
macro attach s \
        "<save-entry><bol>~/Downloads/<eol>" \
        "save to downloads folder"
macro index,pager <Esc>a  '| git am -s'\n  "Git apply email patch"
# macro index <Esc>R \
#         "<tag-thread><tag-prefix><edit-label>receipt<enter><tag-prefix><save-message>+Archive<enter>" \
#         "receipt and archive"
# macro pager <Esc>R \
#         "<edit-label>receipt<enter><Up><save-message>+Archive<enter>" \
#         "receipt and archive"

macro index \\ "<vfolder-from-query>"
# macro index,pager A "<modify-labels>+archive -unread -inbox\n"
bind index,pager + entire-thread
bind index,pager y modify-labels

# contacts
set query_command = "notmuch address %s"
set query_format = "%5c %t %a %n %?e?(%e)?"

# editor
bind editor <Tab> complete-query
bind editor ^T    complete

# sort/threading
set sort = threads
set sort_aux = reverse-last-date-received
set sort_re
set collapse_unread = yes
set uncollapse_jump = yes
folder-hook . "exec collapse-all"

# look and feel
set pager_index_lines = 8
set pager_context = 5
set pager_stop = yes
set menu_scroll = yes
set smart_wrap = yes
set tilde = yes
set markers = no
set help = no
set text_flowed = yes

set index_format="%4C %Z %[%D] %-15.15L %s"

# don't make me press enter after shell command is run
set wait_key = no

# speed up folder switching
set sleep_time = 0

# html mails
auto_view text/v-card text/html text/enriched text/calendar application/ics
alternative_order text/plain text/enriched text/html

# tag transformations
tag-transforms "inbox"   "i"   \
               "unread"  "u"   \
               "replied" "‚Ü©Ô∏é"  \
               "sent"    "‚û• "  \
               "todo"    "T"   \
               "deleted" "‚ê°" \
               "invites" "üìÖ" \
               "attachment" "@" \
               "encrypted"  "ÓÇ¢" \
               "signed"     "‚úé" \
               "github-issues" "gh"
tag-formats "attachment" "GA" \
            "encrypted"  "GE" \
            "signed"     "GS"

# sidebar
set mail_check_stats = yes
set sidebar_visible = yes
set sidebar_width = 20
set sidebar_new_mail_only = no
set sidebar_sort_method = 'unsorted'
set sidebar_format = "%D%* %?N?(%N)? %S"

# sidebar bindings
bind index,pager B sidebar-toggle-visible
bind index,pager \CP sidebar-prev
bind index,pager \CN sidebar-next
bind index <left> sidebar-prev          # got to previous folder in sidebar
bind index <right> sidebar-next         # got to next folder in sidebar
bind index <space> sidebar-open         # open selected folder from sidebar

# composing
set fcc_attach
unset mime_forward
set forward_format = "Fwd: %s"
set include
set forward_quote
set signature = ~/.config/neomutt/signature

# mail headers
ignore * # first, ignore all headers
unignore from: to: cc: bcc: reply-to: date: subject: x-label: # then, show only these
hdr_order from: to: cc: bcc: reply-to: date: subject: x-label: # and in this order

# seperate accounts
folder-hook 'Home' 'source ~/.config/neomutt/neomuttrc.home'
folder-hook 'Lullabot' 'source ~/.config/neomutt/neomuttrc.lullabot'

# attachments
set abort_noattach = ask-yes

# pgp
source ~/.config/neomutt/gpg.rc
set pgp_use_gpg_agent = yes
set pgp_timeout = 3600
set crypt_auto_sign = no
set crypt_reply_encrypt = yes

# colors
source ~/.config/neomutt/colors

# subscribed mailing lists
# see https://neomutt.org/guide/advancedusage#11-%C2%A0handling-mailing-lists
subscribe neomutt-users
lists lists.sr.ht
subscribe sr.ht-announce
subscribe sr.ht-dev

# vim: ft=neomuttrc et
